# Модель по построению оптимальных маршрутов инкассации платежных терминалов
## Модель позволяет строить оптимальные маршруты инкассации с учетом бизнес-ограничений.

При разработке модели необходимо было провести моделирование на тренировочном датасете, состоящем из данных по двум месяцам наблюдений, и тестовой выборке за один месяц наблюдений. Для этого была сформирована модель __model_route_test__ , в которой последовательно формировалось текущее состояние терминалов, на основе маршрутов, совершенных в предыдущий день. В результате был сформирован отчет, содержащий информацию об остатках в терминалах, стоимостях инкассирования и фондирования, а также маршруты на каждый день в течение трех месяцев.

В связи с тем, что для промышленной эксплуатации необходимо производить моделирование в другом режиме, когда на момент моделирования маршрутов известны остатки в терминалах на текущий период, было решено создать модель __model_route__, имеющую тот же способ прогнозирования, выбора требуемых к посещению терминалов и построения маршрутов. Результатом работы полученной модели является маршрутный лист на день, а также издержки на инкассирование и фондирование за день.

### Моделирование состоит из следующих этапов:
1. Прогнозирование прироста наличности в терминалах на следующий день.
2. Отбор терминалов, требующих посещения, на основе метрики важности терминала в текущий день.
3. Формирование оптимального маршрута по выбранным терминалам с помощью оптимизации методом муравьиных колоний (ACO).
4. Формирование отчетов, содержащих издержки на инкассирование и фондирование, а также маршрутного листа с указанием времени прибытия и убытия на каждый терминал для каждого броневика.

#### Входные данные:
- данные по текущему наполненнию терминалов и приростам в ретроспекте (incomes.csv), столбцы имеют вид:
  - TID - номер терминала,
  - текущий остаток - остаток в терминалах на текущий день,
  - дата (в формате "ДД.ММ.ГГГГ  0:00:00") - приросты наличности в терминалах на указанный день;
- данные по времени в пути между терминалами (times v4.csv), столбцы имеют вид:
  - Origin_tid - терминал отправления,
  - Destitation_tid - терминал назначения,
  - Total_Time - время в пути;
- данные по координатам терминалов (times.csv), столбцы имеют вид:
  - TID - номер терминала,
  - longitude - координата долготы,
  - latitude - координата широты.

Дополнительно при первом запуске необходимо приложить файл с данными по датам последних посещений терминалов (days_last_visited.csv), где столбцы имеют вид:
  - tid - номер терминала,
  - date - дата последнего посещения в формате "ДД.ММ.ГГГГ".

Если вы не располагаете данными о датах последних посещений терминалов, необходимо заполнить файл датой предыдущего дня. В дальнейшем этот файл автоматически заполняется и обновляется при запуске моделирования.

#### Выходные данные:
- log_fond.csv - файл, содержащий стоимость фондирования по каждому терминалу в день (величину % в годовых, которую банк платит за неинкассированную сумму денег в терминале),
- log_ink.csv - файл, содержащий стоимость инкассирования по каждому терминалу в день,
- log_route.csv - файл, содержащий маршруты каждой машины с указанием время прибытия и убытия на каждый терминал маршрута,
- days_last_visited.csv - системный файл, содержащий даты последнего посещения каждого терминала.

# Работа с моделью __model_route__
В разделе "Пути к файлам, параметры для моделирования и ограничения" необходимо указать путь к файлам с исходными данными и путь для сохранения файлов с отчетами.
Параметры моделирования и ограничения установлены в соответствии с заданием на разработку, но тем не менее могут изменятся при необходимости.

После задания необходимых путей, необходимо выполнить весь скрипт файла. В результате выведется сообщение о сумме издержек за день, а в указанной папке сохранятся отчеты по стоимости инкассирования и фондирования терминалов и маршруты объезда терминалов на текущий день.
